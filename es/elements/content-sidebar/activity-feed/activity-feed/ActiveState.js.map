{"version":3,"sources":["../../../../../src/elements/content-sidebar/activity-feed/activity-feed/ActiveState.js"],"names":["React","getProp","noop","ActivityThread","ActivityItem","AppActivity","AnnotationActivity","Comment","TaskNew","Version","CollapsedVersion","withErrorHandling","BaseComment","FEED_ITEM_TYPE_ANNOTATION","FEED_ITEM_TYPE_APP_ACTIVITY","FEED_ITEM_TYPE_COMMENT","FEED_ITEM_TYPE_TASK","FEED_ITEM_TYPE_VERSION","AnnotationActivityLinkProvider","ActiveState","activeFeedItem","activeFeedItemRef","approverSelectorContacts","currentFileVersionId","currentUser","getApproverWithQuery","getAvatarUrl","getMentionWithQuery","getUserProfileUrl","hasNewThreadedReplies","hasReplies","hasVersions","items","mentionSelectorContacts","onAnnotationDelete","onAnnotationEdit","onAnnotationSelect","onAnnotationStatusChange","onAppActivityDelete","onCommentDelete","onCommentEdit","onCommentSelect","onHideReplies","onReplyCreate","onReplyDelete","onReplyUpdate","onShowReplies","onTaskAssignmentUpdate","onTaskDelete","onTaskEdit","onTaskModalClose","onTaskView","onVersionInfo","shouldUseUAA","translations","onCommentSelectHandler","itemId","isSelected","onHideRepliesHandler","parentId","lastReply","onReplyCreateHandler","parentType","text","onReplyDeleteHandler","options","onReplyUpdateHandler","id","status","hasMention","permissions","onSuccess","onError","onShowRepliesHandler","type","map","item","isFocused","refValue","undefined","itemFileVersionId","replyProps","onReplySelect","commentAndAnnotationCommonProps","shownReplies","onSelect","can_delete","can_edit","can_reply","can_resolve","repliesTotalCount","total_reply_count","reply","isPending","isRepliesLoading","replies","versions","description","message","ActiveStateComponent"],"mappings":"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","sourcesContent":["/**\n * @flow\n * @file Active state component for Activity Feed\n */\nimport * as React from 'react';\nimport getProp from 'lodash/get';\nimport noop from 'lodash/noop';\nimport ActivityThread from './ActivityThread';\nimport ActivityItem from './ActivityItem';\nimport AppActivity from '../app-activity';\nimport AnnotationActivity from '../annotations';\nimport Comment from '../comment';\nimport TaskNew from '../task-new';\nimport Version, { CollapsedVersion } from '../version';\nimport withErrorHandling from '../../withErrorHandling';\nimport { BaseComment } from '../comment/BaseComment';\nimport {\n    FEED_ITEM_TYPE_ANNOTATION,\n    FEED_ITEM_TYPE_APP_ACTIVITY,\n    FEED_ITEM_TYPE_COMMENT,\n    FEED_ITEM_TYPE_TASK,\n    FEED_ITEM_TYPE_VERSION,\n} from '../../../../constants';\nimport type {\n    Annotation,\n    AnnotationPermission,\n    BoxCommentPermission,\n    Comment as CommentType,\n    CommentFeedItemType,\n    FeedItem,\n    FeedItems,\n    FeedItemStatus,\n} from '../../../../common/types/feed';\nimport type { SelectorItems, User } from '../../../../common/types/core';\nimport type { GetAvatarUrlCallback, GetProfileUrlCallback } from '../../../common/flowTypes';\nimport type { Translations } from '../../flowTypes';\n\nimport { type OnAnnotationEdit, type OnCommentEdit } from '../comment/types';\nimport AnnotationActivityLinkProvider from './AnnotationActivityLinkProvider';\n\ntype Props = {\n    activeFeedItem: FeedItem,\n    activeFeedItemRef: { current: null | HTMLElement },\n    approverSelectorContacts?: SelectorItems<>,\n    currentFileVersionId: string,\n    currentUser?: User,\n    getApproverWithQuery?: Function,\n    getAvatarUrl: GetAvatarUrlCallback,\n    getMentionWithQuery?: Function,\n    getUserProfileUrl?: GetProfileUrlCallback,\n    hasNewThreadedReplies?: boolean,\n    hasReplies?: boolean,\n    hasVersions?: boolean,\n    items: FeedItems,\n    mentionSelectorContacts?: SelectorItems<>,\n    onAnnotationDelete?: ({ id: string, permissions: AnnotationPermission }) => void,\n    onAnnotationEdit?: OnAnnotationEdit,\n    onAnnotationSelect?: (annotation: Annotation) => void,\n    onAnnotationStatusChange?: (id: string, status: FeedItemStatus, permissions: AnnotationPermission) => void,\n    onAppActivityDelete?: Function,\n    onCommentDelete?: Function,\n    onCommentEdit?: OnCommentEdit,\n    onCommentSelect?: (id: string | null) => void,\n    onHideReplies?: (id: string, replies: Array<CommentType>) => void,\n    onReplyCreate?: (parentId: string, parentType: CommentFeedItemType, text: string) => void,\n    onReplyDelete?: ({ id: string, parentId: string, permissions: BoxCommentPermission }) => void,\n    onReplyUpdate?: (\n        id: string,\n        parentId: string,\n        text: string,\n        permissions: BoxCommentPermission,\n        onSuccess: ?Function,\n        onError: ?Function,\n    ) => void,\n    onShowReplies?: (id: string, type: CommentFeedItemType) => void,\n    onTaskAssignmentUpdate?: Function,\n    onTaskDelete?: Function,\n    onTaskEdit?: Function,\n    onTaskModalClose?: Function,\n    onTaskView?: Function,\n    onVersionInfo?: Function,\n    shouldUseUAA?: boolean,\n    translations?: Translations,\n};\n\nconst ActiveState = ({\n    activeFeedItem,\n    activeFeedItemRef,\n    approverSelectorContacts,\n    currentFileVersionId,\n    currentUser,\n    getApproverWithQuery,\n    getAvatarUrl,\n    getMentionWithQuery,\n    getUserProfileUrl,\n    hasNewThreadedReplies = false,\n    hasReplies = false,\n    hasVersions,\n    items,\n    mentionSelectorContacts,\n    onAnnotationDelete,\n    onAnnotationEdit,\n    onAnnotationSelect,\n    onAnnotationStatusChange,\n    onAppActivityDelete,\n    onCommentDelete,\n    onCommentEdit,\n    onCommentSelect = noop,\n    onHideReplies = noop,\n    onReplyCreate = noop,\n    onReplyDelete = noop,\n    onReplyUpdate = noop,\n    onShowReplies = noop,\n    onTaskAssignmentUpdate,\n    onTaskDelete,\n    onTaskEdit,\n    onTaskModalClose,\n    onTaskView,\n    onVersionInfo,\n    shouldUseUAA,\n    translations,\n}: Props): React.Node => {\n    const onCommentSelectHandler = (itemId: string) => (isSelected: boolean) => {\n        onCommentSelect(isSelected ? itemId : null);\n    };\n    const onHideRepliesHandler = (parentId: string) => (lastReply: CommentType) => {\n        onHideReplies(parentId, [lastReply]);\n    };\n    const onReplyCreateHandler = (parentId: string, parentType: CommentFeedItemType) => (text: string) => {\n        onReplyCreate(parentId, parentType, text);\n    };\n    const onReplyDeleteHandler = (parentId: string) => (options: { id: string, permissions: BoxCommentPermission }) => {\n        onReplyDelete({ ...options, parentId });\n    };\n    const onReplyUpdateHandler = (parentId: string) => (\n        id: string,\n        text: string,\n        status?: FeedItemStatus,\n        hasMention?: boolean,\n        permissions: BoxCommentPermission,\n        onSuccess: ?Function,\n        onError: ?Function,\n    ) => {\n        onReplyUpdate(id, parentId, text, permissions, onSuccess, onError);\n    };\n    const onShowRepliesHandler = (id: string, type: CommentFeedItemType) => () => {\n        onShowReplies(id, type);\n    };\n\n    return (\n        <ul className=\"bcs-activity-feed-active-state\">\n            {items.map((item: FeedItem) => {\n                const isFocused = item === activeFeedItem;\n                const refValue = isFocused ? activeFeedItemRef : undefined;\n                const itemFileVersionId = getProp(item, 'file_version.id');\n                const replyProps = {\n                    hasReplies,\n                    onReplySelect: onCommentSelectHandler(item.id),\n                };\n\n                const commentAndAnnotationCommonProps = {\n                    ...item,\n                    ...replyProps,\n                    currentUser,\n                    getAvatarUrl,\n                    getMentionWithQuery,\n                    getUserProfileUrl,\n                    mentionSelectorContacts,\n                    onHideReplies: shownReplies => onHideReplies(item.id, shownReplies),\n                    onSelect: onCommentSelectHandler(item.id),\n                    permissions: {\n                        can_delete: getProp(item.permissions, 'can_delete', false),\n                        can_edit: getProp(item.permissions, 'can_edit', false),\n                        can_reply: getProp(item.permissions, 'can_reply', false),\n                        can_resolve: getProp(item.permissions, 'can_resolve', false),\n                    },\n                    // TODO: legitimate, pre-existing typing issue that was previously undetected\n                    // $FlowFixMe\n                    repliesTotalCount: item.total_reply_count,\n                    translations,\n                };\n\n                switch (item.type) {\n                    case FEED_ITEM_TYPE_COMMENT:\n                        return (\n                            <ActivityItem\n                                key={item.type + item.id}\n                                data-testid=\"comment\"\n                                isFocused={isFocused}\n                                isHoverable\n                                hasNewThreadedReplies={hasNewThreadedReplies}\n                                ref={refValue}\n                            >\n                                {hasNewThreadedReplies ? (\n                                    // TODO: legitimate, pre-existing typing issue that was previously undetected\n                                    // Conflict between BoxCommentPermissions and BoxTaskPermissions\n                                    // $FlowFixMe\n                                    <BaseComment\n                                        {...commentAndAnnotationCommonProps}\n                                        onDelete={onCommentDelete}\n                                        onCommentEdit={onCommentEdit}\n                                        onReplyCreate={reply => onReplyCreate(item.id, FEED_ITEM_TYPE_COMMENT, reply)}\n                                        onShowReplies={() => onShowReplies(item.id, FEED_ITEM_TYPE_COMMENT)}\n                                    />\n                                ) : (\n                                    <ActivityThread\n                                        data-testid=\"activity-thread\"\n                                        currentUser={currentUser}\n                                        getAvatarUrl={getAvatarUrl}\n                                        getMentionWithQuery={getMentionWithQuery}\n                                        getUserProfileUrl={getUserProfileUrl}\n                                        hasNewThreadedReplies={hasNewThreadedReplies}\n                                        hasReplies={hasReplies}\n                                        isPending={item.isPending}\n                                        isRepliesLoading={item.isRepliesLoading}\n                                        mentionSelectorContacts={mentionSelectorContacts}\n                                        onHideReplies={onHideRepliesHandler(item.id)}\n                                        onReplyCreate={onReplyCreateHandler(item.id, item.type)}\n                                        onReplyDelete={onReplyDeleteHandler(item.id)}\n                                        onReplyEdit={onReplyUpdateHandler(item.id)}\n                                        onReplySelect={onCommentSelectHandler(item.id)}\n                                        onShowReplies={onShowRepliesHandler(item.id, item.type)}\n                                        repliesTotalCount={item.total_reply_count}\n                                        replies={item.replies}\n                                        translations={translations}\n                                    >\n                                        <Comment\n                                            {...item}\n                                            currentUser={currentUser}\n                                            getAvatarUrl={getAvatarUrl}\n                                            getMentionWithQuery={getMentionWithQuery}\n                                            getUserProfileUrl={getUserProfileUrl}\n                                            mentionSelectorContacts={mentionSelectorContacts}\n                                            onDelete={onCommentDelete}\n                                            onEdit={onCommentEdit}\n                                            onSelect={onCommentSelectHandler(item.id)}\n                                            permissions={{\n                                                can_delete: getProp(item.permissions, 'can_delete', false),\n                                                can_edit: getProp(item.permissions, 'can_edit', false),\n                                                can_reply: getProp(item.permissions, 'can_reply', false),\n                                                can_resolve: getProp(item.permissions, 'can_resolve', false),\n                                            }}\n                                            translations={translations}\n                                        />\n                                    </ActivityThread>\n                                )}\n                            </ActivityItem>\n                        );\n                    case FEED_ITEM_TYPE_TASK:\n                        return (\n                            <ActivityItem\n                                key={item.type + item.id}\n                                className=\"bcs-activity-feed-task-new\"\n                                data-testid=\"task\"\n                                isFocused={isFocused}\n                                ref={refValue}\n                            >\n                                <TaskNew\n                                    {...item}\n                                    approverSelectorContacts={approverSelectorContacts}\n                                    currentUser={currentUser}\n                                    getApproverWithQuery={getApproverWithQuery}\n                                    getAvatarUrl={getAvatarUrl}\n                                    getUserProfileUrl={getUserProfileUrl}\n                                    onAssignmentUpdate={onTaskAssignmentUpdate}\n                                    onDelete={onTaskDelete}\n                                    onEdit={onTaskEdit}\n                                    onView={onTaskView}\n                                    onModalClose={onTaskModalClose}\n                                    shouldUseUAA={shouldUseUAA}\n                                    translations={translations}\n                                />\n                            </ActivityItem>\n                        );\n                    case FEED_ITEM_TYPE_VERSION:\n                        return (\n                            <ActivityItem key={item.type + item.id} className=\"bcs-version-item\" data-testid=\"version\">\n                                {item.versions ? (\n                                    // $FlowFixMe\n                                    <CollapsedVersion {...item} onInfo={onVersionInfo} />\n                                ) : (\n                                    // $FlowFixMe\n                                    <Version {...item} onInfo={onVersionInfo} />\n                                )}\n                            </ActivityItem>\n                        );\n                    case FEED_ITEM_TYPE_APP_ACTIVITY:\n                        return (\n                            <ActivityItem\n                                key={item.type + item.id}\n                                className=\"bcs-activity-feed-app-activity\"\n                                data-testid=\"app-activity\"\n                            >\n                                <AppActivity currentUser={currentUser} onDelete={onAppActivityDelete} {...item} />\n                            </ActivityItem>\n                        );\n                    case FEED_ITEM_TYPE_ANNOTATION:\n                        return (\n                            <ActivityItem\n                                key={item.type + item.id}\n                                className=\"bcs-activity-feed-annotation-activity\"\n                                data-testid=\"annotation-activity\"\n                                isHoverable\n                                hasNewThreadedReplies={hasNewThreadedReplies}\n                                isFocused={isFocused}\n                                ref={refValue}\n                            >\n                                {hasNewThreadedReplies && onAnnotationSelect ? (\n                                    // TODO: legitimate, pre-existing typing issue that was previously undetected\n                                    // Conflict between BoxCommentPermissions and BoxTaskPermissions\n                                    // $FlowFixMe\n                                    <BaseComment\n                                        {...commentAndAnnotationCommonProps}\n                                        annotationActivityLink={\n                                            <AnnotationActivityLinkProvider\n                                                item={item}\n                                                onSelect={onAnnotationSelect}\n                                                isCurrentVersion={currentFileVersionId === itemFileVersionId}\n                                            />\n                                        }\n                                        onAnnotationEdit={onAnnotationEdit}\n                                        onDelete={onAnnotationDelete}\n                                        onReplyCreate={reply =>\n                                            onReplyCreate(item.id, FEED_ITEM_TYPE_ANNOTATION, reply)\n                                        }\n                                        onShowReplies={() => onShowReplies(item.id, FEED_ITEM_TYPE_ANNOTATION)}\n                                        tagged_message={item.description?.message ?? ''}\n                                    />\n                                ) : (\n                                    <ActivityThread\n                                        data-testid=\"activity-thread\"\n                                        currentUser={currentUser}\n                                        getAvatarUrl={getAvatarUrl}\n                                        getMentionWithQuery={getMentionWithQuery}\n                                        getUserProfileUrl={getUserProfileUrl}\n                                        hasNewThreadedReplies={hasNewThreadedReplies}\n                                        hasReplies={hasReplies}\n                                        isPending={item.isPending}\n                                        isRepliesLoading={item.isRepliesLoading}\n                                        mentionSelectorContacts={mentionSelectorContacts}\n                                        onHideReplies={onHideRepliesHandler(item.id)}\n                                        onReplyCreate={onReplyCreateHandler(item.id, item.type)}\n                                        onReplyDelete={onReplyDeleteHandler(item.id)}\n                                        onReplyEdit={onReplyUpdateHandler(item.id)}\n                                        onReplySelect={onCommentSelectHandler(item.id)}\n                                        onShowReplies={onShowRepliesHandler(item.id, item.type)}\n                                        repliesTotalCount={item.total_reply_count}\n                                        replies={item.replies}\n                                        translations={translations}\n                                    >\n                                        <AnnotationActivity\n                                            currentUser={currentUser}\n                                            getAvatarUrl={getAvatarUrl}\n                                            getUserProfileUrl={getUserProfileUrl}\n                                            getMentionWithQuery={getMentionWithQuery}\n                                            hasVersions={hasVersions}\n                                            isCurrentVersion={currentFileVersionId === itemFileVersionId}\n                                            item={item}\n                                            mentionSelectorContacts={mentionSelectorContacts}\n                                            onEdit={onAnnotationEdit}\n                                            onDelete={onAnnotationDelete}\n                                            onSelect={onAnnotationSelect}\n                                            onStatusChange={onAnnotationStatusChange}\n                                        />\n                                    </ActivityThread>\n                                )}\n                            </ActivityItem>\n                        );\n                    default:\n                        return null;\n                }\n            })}\n        </ul>\n    );\n};\n\nexport { ActiveState as ActiveStateComponent };\nexport default withErrorHandling(ActiveState);\n"],"file":"ActiveState.js"}