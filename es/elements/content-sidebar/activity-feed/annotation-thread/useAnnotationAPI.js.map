{"version":3,"sources":["../../../../../src/elements/content-sidebar/activity-feed/annotation-thread/useAnnotationAPI.js"],"names":["API","useAnnotationAPI","api","errorCallback","file","fileId","id","file_version","fileVersionId","permissions","filePermissions","handleCreate","payload","successCallback","getAnnotationsAPI","createAnnotation","handleFetch","getAnnotation","handleDelete","deleteAnnotation","handleEdit","text","updateAnnotation","message","handleStatusChange","status"],"mappings":"AACA,OAAOA,GAAP,MAAgB,4BAAhB;;AAoCA,IAAMC,gBAAgB,GAAG,SAAnBA,gBAAmB,OAIM;AAAA,MAH3BC,GAG2B,QAH3BA,GAG2B;AAAA,MAF3BC,aAE2B,QAF3BA,aAE2B;AAAA,uBAD3BC,IAC2B;AAAA,MADfC,MACe,aADnBC,EACmB;AAAA,wCADPC,YACO;AAAA,6DAD+B,EAC/B;AAAA,MADaC,aACb,yBADSF,EACT;AAAA,wCADmCG,WACnC;AAAA,MADgDC,eAChD,sCADkE,EAClE;;AAC3B,MAAMC,YAAY,GAAG,SAAfA,YAAe,QAMT;AAAA,QALRC,OAKQ,SALRA,OAKQ;AAAA,QAJRC,eAIQ,SAJRA,eAIQ;AACRX,IAAAA,GAAG,CAACY,iBAAJ,CAAsB,KAAtB,EAA6BC,gBAA7B,CACIV,MADJ,EAEIG,aAFJ,EAGII,OAHJ,EAIIF,eAJJ,EAKIG,eALJ,EAMIV,aANJ;AAQH,GAfD;;AAiBA,MAAMa,WAAW,GAAG,SAAdA,WAAc,QAMR;AAAA,QALRV,EAKQ,SALRA,EAKQ;AAAA,QAJRO,eAIQ,SAJRA,eAIQ;AACRX,IAAAA,GAAG,CAACY,iBAAJ,CAAsB,KAAtB,EAA6BG,aAA7B,CACIZ,MADJ,EAEIC,EAFJ,EAGII,eAHJ,EAIIG,eAJJ,EAKIV,aALJ,EAMI,IANJ,CAMU;AANV;AAQH,GAfD;;AAiBA,MAAMe,YAAY,GAAG,SAAfA,YAAe,QAQT;AAAA,QAPRZ,EAOQ,SAPRA,EAOQ;AAAA,QANRG,WAMQ,SANRA,WAMQ;AAAA,QALRI,eAKQ,SALRA,eAKQ;AACRX,IAAAA,GAAG,CAACY,iBAAJ,CAAsB,KAAtB,EAA6BK,gBAA7B,CAA8Cd,MAA9C,EAAsDC,EAAtD,EAA0DG,WAA1D,EAAuEI,eAAvE,EAAwFV,aAAxF;AACH,GAVD;;AAYA,MAAMiB,UAAU,GAAG,SAAbA,UAAa,QAUP;AAAA,QATRd,EASQ,SATRA,EASQ;AAAA,QARRe,IAQQ,SARRA,IAQQ;AAAA,QAPRZ,WAOQ,SAPRA,WAOQ;AAAA,QANRI,eAMQ,SANRA,eAMQ;AACRX,IAAAA,GAAG,CAACY,iBAAJ,CAAsB,KAAtB,EAA6BQ,gBAA7B,CACIjB,MADJ,EAEIC,EAFJ,EAGIG,WAHJ,EAII;AAAEc,MAAAA,OAAO,EAAEF;AAAX,KAJJ,EAKIR,eALJ,EAMIV,aANJ;AAQH,GAnBD;;AAqBA,MAAMqB,kBAAkB,GAAG,SAArBA,kBAAqB,QAUf;AAAA,QATRlB,EASQ,SATRA,EASQ;AAAA,QARRmB,MAQQ,SARRA,MAQQ;AAAA,QAPRhB,WAOQ,SAPRA,WAOQ;AAAA,QANRI,eAMQ,SANRA,eAMQ;AACRX,IAAAA,GAAG,CAACY,iBAAJ,CAAsB,KAAtB,EAA6BQ,gBAA7B,CACIjB,MADJ,EAEIC,EAFJ,EAGIG,WAHJ,EAII;AAAEgB,MAAAA,MAAM,EAANA;AAAF,KAJJ,EAKIZ,eALJ,EAMIV,aANJ;AAQH,GAnBD;;AAqBA,SAAO;AACHQ,IAAAA,YAAY,EAAZA,YADG;AAEHK,IAAAA,WAAW,EAAXA,WAFG;AAGHE,IAAAA,YAAY,EAAZA,YAHG;AAIHE,IAAAA,UAAU,EAAVA,UAJG;AAKHI,IAAAA,kBAAkB,EAAlBA;AALG,GAAP;AAOH,CApGD;;AAsGA,eAAevB,gBAAf","sourcesContent":["// @flow\nimport API from '../../../../api/APIFactory';\n\nimport type { Annotation, AnnotationPermission, NewAnnotation } from '../../../../common/types/annotations';\nimport type { BoxItem } from '../../../../common/types/core';\nimport type { FeedItemStatus } from '../../../../common/types/feed';\nimport type { ElementOrigin, ElementsXhrError } from '../../../../common/types/api';\n\ntype Props = {\n    api: API,\n    errorCallback: (\n        error: ElementsXhrError | Error,\n        code: string,\n        contextInfo?: Object,\n        origin?: ElementOrigin,\n    ) => void,\n    file: BoxItem,\n};\n\ntype UseAnnotationAPI = {\n    handleCreate: ({ payload: NewAnnotation, successCallback: (annotation: Annotation) => void }) => void,\n    handleDelete: ({ id: string, permissions: AnnotationPermission, successCallback: () => void }) => void,\n    handleEdit: ({\n        id: string,\n        permissions: AnnotationPermission,\n        successCallback: (annotation: Annotation) => void,\n        text: string,\n    }) => void,\n    handleFetch: ({ id: string, successCallback: (annotation: Annotation) => void }) => void,\n    handleStatusChange: ({\n        id: string,\n        permissions: AnnotationPermission,\n        status: FeedItemStatus,\n        successCallback: (annotation: Annotation) => void,\n    }) => void,\n};\n\nconst useAnnotationAPI = ({\n    api,\n    errorCallback,\n    file: { id: fileId, file_version: { id: fileVersionId } = {}, permissions: filePermissions = {} },\n}: Props): UseAnnotationAPI => {\n    const handleCreate = ({\n        payload,\n        successCallback,\n    }: {\n        payload: NewAnnotation,\n        successCallback: (annotation: Annotation) => void,\n    }): void => {\n        api.getAnnotationsAPI(false).createAnnotation(\n            fileId,\n            fileVersionId,\n            payload,\n            filePermissions,\n            successCallback,\n            errorCallback,\n        );\n    };\n\n    const handleFetch = ({\n        id,\n        successCallback,\n    }: {\n        id: string,\n        successCallback: (annotation: Annotation) => void,\n    }): void => {\n        api.getAnnotationsAPI(false).getAnnotation(\n            fileId,\n            id,\n            filePermissions,\n            successCallback,\n            errorCallback,\n            true, // to fetch aanotation with its replies\n        );\n    };\n\n    const handleDelete = ({\n        id,\n        permissions,\n        successCallback,\n    }: {\n        id: string,\n        permissions: AnnotationPermission,\n        successCallback: () => void,\n    }): void => {\n        api.getAnnotationsAPI(false).deleteAnnotation(fileId, id, permissions, successCallback, errorCallback);\n    };\n\n    const handleEdit = ({\n        id,\n        text,\n        permissions,\n        successCallback,\n    }: {\n        id: string,\n        permissions: AnnotationPermission,\n        successCallback: (annotation: Annotation) => void,\n        text: string,\n    }): void => {\n        api.getAnnotationsAPI(false).updateAnnotation(\n            fileId,\n            id,\n            permissions,\n            { message: text },\n            successCallback,\n            errorCallback,\n        );\n    };\n\n    const handleStatusChange = ({\n        id,\n        status,\n        permissions,\n        successCallback,\n    }: {\n        id: string,\n        permissions: AnnotationPermission,\n        status: FeedItemStatus,\n        successCallback: (annotation: Annotation) => void,\n    }): void => {\n        api.getAnnotationsAPI(false).updateAnnotation(\n            fileId,\n            id,\n            permissions,\n            { status },\n            successCallback,\n            errorCallback,\n        );\n    };\n\n    return {\n        handleCreate,\n        handleFetch,\n        handleDelete,\n        handleEdit,\n        handleStatusChange,\n    };\n};\n\nexport default useAnnotationAPI;\n"],"file":"useAnnotationAPI.js"}