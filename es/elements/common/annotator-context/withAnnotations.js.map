{"version":3,"sources":["../../../../src/elements/common/annotator-context/withAnnotations.tsx"],"names":["getProp","React","generatePath","matchPath","AnnotatorContext","Action","Status","ANNOTATIONS_PATH","defaultState","action","activeAnnotationFileVersionId","activeAnnotationId","annotation","annotationReply","error","meta","withAnnotations","WrappedComponent","ComponentWithAnnotations","props","id","annotator","emit","isStartEvent","event","reply","requestId","annotationId","eventData","onError","showNotification","setState","state","getAction","getDeleteAction","getUpdateAction","getReplyCreateAction","getReplyDeleteAction","getReplyUpdateAction","fileVersionId","addListener","handleActiveChange","handleAnnotationCreate","handleAnnotationDelete","handleAnnotationFetchError","handleAnnotationUpdate","handleAnnotationReplyCreate","handleAnnotationReplyDelete","handleAnnotationReplyUpdate","shouldReset","removeListener","location","match","getMatchPath","status","SUCCESS","CREATE_END","CREATE_START","DELETE_END","DELETE_START","UPDATE_END","UPDATE_START","REPLY_CREATE_END","REPLY_CREATE_START","REPLY_DELETE_END","REPLY_DELETE_START","REPLY_UPDATE_END","REPLY_UPDATE_START","sidebar","undefined","pathname","path","exact","emitActiveAnnotationChangeEvent","emitAnnotationRemoveEvent","emitAnnotationReplyCreateEvent","emitAnnotationReplyDeleteEvent","emitAnnotationReplyUpdateEvent","emitAnnotationUpdateEvent","getAnnotationsMatchPath","getAnnotationsPath","handleAnnotator","handlePreviewDestroy","Component","displayName","name"],"mappings":"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","sourcesContent":["// @ts-nocheck\nimport { Location } from 'history';\nimport getProp from 'lodash/get';\nimport * as React from 'react';\nimport { generatePath, matchPath, match as matchType } from 'react-router-dom';\nimport AnnotatorContext from './AnnotatorContext';\nimport { Action, AnnotationActionEvent, Annotator, AnnotatorState, GetMatchPath, MatchParams, Status } from './types';\n\nexport type ActiveChangeEvent = {\n    annotationId: string | null;\n    fileVersionId: string;\n};\n\nexport type ActiveChangeEventHandler = (event: ActiveChangeEvent) => void;\n\nexport type ComponentWithAnnotations = {\n    emitActiveAnnotationChangeEvent: (id: string | null) => void;\n    emitAnnotationRemoveEvent: (id: string, isStartEvent?: boolean) => void;\n    emitAnnotationReplyCreateEvent: (\n        reply: Object,\n        requestId: string,\n        annotationId: string,\n        isStartEvent?: boolean,\n    ) => void;\n    emitAnnotationReplyDeleteEvent: (id: string, annotationId: string, isStartEvent?: boolean) => void;\n    emitAnnotationReplyUpdateEvent: (reply: Object, annotationId: string, isStartEvent?: boolean) => void;\n    emitAnnotationUpdateEvent: (annotation: Object, isStartEvent?: boolean) => void;\n    getAction: (eventData: AnnotationActionEvent) => Action;\n    getAnnotationsPath: (fileVersionId?: string, annotationId?: string | null) => string;\n    getMatchPath: GetMatchPath;\n    handleActiveChange: ActiveChangeEventHandler;\n    handleAnnotationChangeEvent: (id: string | null) => void;\n    handleAnnotationCreate: (eventData: AnnotationActionEvent) => void;\n    handleAnnotationDelete: (eventData: AnnotationActionEvent) => void;\n    handleAnnotationFetchError: ({ error }: { error: Error }) => void;\n    handleAnnotationReplyCreate: (eventData: AnnotationActionEvent) => void;\n    handleAnnotationReplyDelete: (eventData: AnnotationActionEvent) => void;\n    handleAnnotationReplyUpdate: (eventData: AnnotationActionEvent) => void;\n    handleAnnotationUpdate: (eventData: AnnotationActionEvent) => void;\n    handleAnnotator: (annotator: Annotator) => void;\n    handlePreviewDestroy: (shouldReset?: boolean) => void;\n};\n\nexport type WithAnnotationsProps = {\n    location?: Location;\n    onAnnotator: (annotator: Annotator) => void;\n    onError?: (error: Error, code: string, contextInfo?: Record<string, unknown>) => void;\n    onPreviewDestroy: (shouldReset?: boolean) => void;\n};\n\nexport type WithAnnotationsComponent<P> = React.ComponentClass<P & WithAnnotationsProps>;\n\nconst ANNOTATIONS_PATH = '/:sidebar/annotations/:fileVersionId/:annotationId?';\nconst defaultState: AnnotatorState = {\n    action: null,\n    activeAnnotationFileVersionId: null,\n    activeAnnotationId: null,\n    annotation: null,\n    annotationReply: null,\n    error: null,\n    meta: null,\n};\n\nexport default function withAnnotations<P extends object>(\n    WrappedComponent: React.ComponentType<P>,\n): WithAnnotationsComponent<P> {\n    class ComponentWithAnnotations extends React.Component<P & WithAnnotationsProps, AnnotatorState> {\n        static displayName: string;\n\n        annotator: Annotator | null = null;\n\n        constructor(props: P & WithAnnotationsProps) {\n            super(props);\n\n            // Determine by url if there is already a deeply linked annotation\n            const { location } = props;\n            const match = this.getMatchPath(location);\n            const activeAnnotationId = getProp(match, 'params.annotationId', null);\n\n            // Seed the initial state with the activeAnnotationId if any from the location path\n            this.state = { ...defaultState, activeAnnotationId };\n        }\n\n        emitActiveAnnotationChangeEvent = (id: string | null) => {\n            const { annotator } = this;\n\n            if (!annotator) {\n                return;\n            }\n\n            annotator.emit('annotations_active_set', id);\n        };\n\n        emitAnnotationRemoveEvent = (id: string, isStartEvent = false) => {\n            const { annotator } = this;\n\n            if (!annotator) {\n                return;\n            }\n\n            // Event name does not include \"sidebar\" namespace because of backwards compatibility with Preview\n            const event = isStartEvent ? 'annotations_remove_start' : 'annotations_remove';\n\n            annotator.emit(event, id);\n        };\n\n        emitAnnotationUpdateEvent = (annotation: Object, isStartEvent = false) => {\n            const { annotator } = this;\n\n            if (!annotator) {\n                return;\n            }\n\n            const event = isStartEvent ? 'sidebar.annotations_update_start' : 'sidebar.annotations_update';\n\n            annotator.emit(event, annotation);\n        };\n\n        emitAnnotationReplyCreateEvent = (\n            reply: Object,\n            requestId: string,\n            annotationId: string,\n            isStartEvent = false,\n        ) => {\n            const { annotator } = this;\n\n            if (!annotator) {\n                return;\n            }\n\n            const event = isStartEvent ? 'sidebar.annotations_reply_create_start' : 'sidebar.annotations_reply_create';\n\n            annotator.emit(event, { annotationId, reply, requestId });\n        };\n\n        emitAnnotationReplyDeleteEvent = (id: string, annotationId: string, isStartEvent = false) => {\n            const { annotator } = this;\n\n            if (!annotator) {\n                return;\n            }\n\n            const event = isStartEvent ? 'sidebar.annotations_reply_delete_start' : 'sidebar.annotations_reply_delete';\n\n            annotator.emit(event, { annotationId, id });\n        };\n\n        emitAnnotationReplyUpdateEvent = (reply: Object, annotationId: string, isStartEvent = false) => {\n            const { annotator } = this;\n\n            if (!annotator) {\n                return;\n            }\n\n            const event = isStartEvent ? 'sidebar.annotations_reply_update_start' : 'sidebar.annotations_reply_update';\n\n            annotator.emit(event, { annotationId, reply });\n        };\n\n        getAction({ meta: { status }, error }: AnnotationActionEvent): Action {\n            return status === Status.SUCCESS || error ? Action.CREATE_END : Action.CREATE_START;\n        }\n\n        getDeleteAction({ meta: { status }, error }: AnnotationActionEvent): Action {\n            return status === Status.SUCCESS || error ? Action.DELETE_END : Action.DELETE_START;\n        }\n\n        getUpdateAction({ meta: { status }, error }: AnnotationActionEvent): Action {\n            return status === Status.SUCCESS || error ? Action.UPDATE_END : Action.UPDATE_START;\n        }\n\n        getReplyCreateAction({ meta: { status }, error }: AnnotationActionEvent): Action {\n            return status === Status.SUCCESS || error ? Action.REPLY_CREATE_END : Action.REPLY_CREATE_START;\n        }\n\n        getReplyDeleteAction({ meta: { status }, error }: AnnotationActionEvent): Action {\n            return status === Status.SUCCESS || error ? Action.REPLY_DELETE_END : Action.REPLY_DELETE_START;\n        }\n\n        getReplyUpdateAction({ meta: { status }, error }: AnnotationActionEvent): Action {\n            return status === Status.SUCCESS || error ? Action.REPLY_UPDATE_END : Action.REPLY_UPDATE_START;\n        }\n\n        getAnnotationsPath(fileVersionId?: string, annotationId?: string | null): string {\n            if (!fileVersionId) {\n                return '/activity';\n            }\n\n            return generatePath(ANNOTATIONS_PATH, {\n                sidebar: 'activity',\n                annotationId: annotationId || undefined,\n                fileVersionId,\n            });\n        }\n\n        getMatchPath(location?: Location): matchType<MatchParams> | null {\n            const pathname = getProp(location, 'pathname', '');\n            return matchPath<MatchParams>({\n                path: ANNOTATIONS_PATH,\n                exact: true,\n            }, pathname);\n        }\n\n        handleAnnotationCreate = (eventData: AnnotationActionEvent): void => {\n            const { annotation = null, error = null, meta = null } = eventData;\n            const { onError } = this.props;\n\n            if (onError && error) {\n                onError(error, 'create_annotation_error', { showNotification: true });\n            }\n\n            this.setState({\n                ...this.state,\n                action: this.getAction(eventData),\n                annotation,\n                error,\n                meta,\n            });\n        };\n\n        handleAnnotationDelete = (eventData: AnnotationActionEvent) => {\n            const { annotation = null, error = null, meta = null } = eventData;\n\n            this.setState({\n                action: this.getDeleteAction(eventData),\n                annotation,\n                error,\n                meta,\n            });\n        };\n\n        handleAnnotationUpdate = (eventData: AnnotationActionEvent) => {\n            const { annotation = null, error = null, meta = null } = eventData;\n\n            this.setState({\n                action: this.getUpdateAction(eventData),\n                annotation,\n                error,\n                meta,\n            });\n        };\n\n        handleAnnotationReplyCreate = (eventData: AnnotationActionEvent) => {\n            const { annotation = null, annotationReply = null, error = null, meta = null } = eventData;\n\n            this.setState({\n                action: this.getReplyCreateAction(eventData),\n                annotation,\n                annotationReply,\n                error,\n                meta,\n            });\n        };\n\n        handleAnnotationReplyDelete = (eventData: AnnotationActionEvent) => {\n            const { annotation = null, annotationReply = null, error = null, meta = null } = eventData;\n\n            this.setState({\n                action: this.getReplyDeleteAction(eventData),\n                annotation,\n                annotationReply,\n                error,\n                meta,\n            });\n        };\n\n        handleAnnotationReplyUpdate = (eventData: AnnotationActionEvent) => {\n            const { annotation = null, annotationReply = null, error = null, meta = null } = eventData;\n\n            this.setState({\n                action: this.getReplyUpdateAction(eventData),\n                annotation,\n                annotationReply,\n                error,\n                meta,\n            });\n        };\n\n        handleActiveChange: ActiveChangeEventHandler = ({ annotationId, fileVersionId }): void => {\n            this.setState({ activeAnnotationFileVersionId: fileVersionId, activeAnnotationId: annotationId });\n        };\n\n        handleAnnotationFetchError = ({ error }: { error: Error }): void => {\n            const { onError } = this.props;\n\n            if (onError && error) {\n                onError(error, 'fetch_annotations_error', { showNotification: true });\n            }\n        };\n\n        handleAnnotator = (annotator: Annotator): void => {\n            this.annotator = annotator;\n            this.annotator.addListener('annotations_active_change', this.handleActiveChange);\n            this.annotator.addListener('annotations_create', this.handleAnnotationCreate);\n            this.annotator.addListener('annotations_delete', this.handleAnnotationDelete);\n            this.annotator.addListener('annotations_fetch_error', this.handleAnnotationFetchError);\n            this.annotator.addListener('annotations_update', this.handleAnnotationUpdate);\n            this.annotator.addListener('annotations_reply_create', this.handleAnnotationReplyCreate);\n            this.annotator.addListener('annotations_reply_delete', this.handleAnnotationReplyDelete);\n            this.annotator.addListener('annotations_reply_update', this.handleAnnotationReplyUpdate);\n        };\n\n        handlePreviewDestroy = (shouldReset = true): void => {\n            if (shouldReset) {\n                this.setState(defaultState);\n            }\n\n            if (this.annotator) {\n                this.annotator.removeListener('annotations_active_change', this.handleActiveChange);\n                this.annotator.removeListener('annotations_create', this.handleAnnotationCreate);\n                this.annotator.removeListener('annotations_delete', this.handleAnnotationDelete);\n                this.annotator.removeListener('annotations_fetch_error', this.handleAnnotationFetchError);\n                this.annotator.removeListener('annotations_update', this.handleAnnotationUpdate);\n                this.annotator.removeListener('annotations_reply_create', this.handleAnnotationReplyCreate);\n                this.annotator.removeListener('annotations_reply_delete', this.handleAnnotationReplyDelete);\n                this.annotator.removeListener('annotations_reply_update', this.handleAnnotationReplyUpdate);\n            }\n\n            this.annotator = null;\n        };\n\n        render(): JSX.Element {\n            return (\n                <AnnotatorContext.Provider\n                    value={{\n                        emitActiveAnnotationChangeEvent: this.emitActiveAnnotationChangeEvent,\n                        emitAnnotationRemoveEvent: this.emitAnnotationRemoveEvent,\n                        emitAnnotationReplyCreateEvent: this.emitAnnotationReplyCreateEvent,\n                        emitAnnotationReplyDeleteEvent: this.emitAnnotationReplyDeleteEvent,\n                        emitAnnotationReplyUpdateEvent: this.emitAnnotationReplyUpdateEvent,\n                        emitAnnotationUpdateEvent: this.emitAnnotationUpdateEvent,\n                        getAnnotationsMatchPath: this.getMatchPath,\n                        getAnnotationsPath: this.getAnnotationsPath,\n                        state: this.state,\n                    }}\n                >\n                    <WrappedComponent\n                        {...this.props}\n                        onAnnotator={this.handleAnnotator}\n                        onPreviewDestroy={this.handlePreviewDestroy}\n                    />\n                </AnnotatorContext.Provider>\n            );\n        }\n    }\n\n    const displayName = WrappedComponent.displayName || WrappedComponent.name || 'Component';\n    ComponentWithAnnotations.displayName = `WithAnnotations(${displayName})`;\n\n    return ComponentWithAnnotations;\n}\n"],"file":"withAnnotations.js"}