{"version":3,"sources":["../../../../src/features/classification/security-controls/utils.js"],"names":["getProp","isNil","appRestrictionsMessageMap","downloadRestrictionsMessageMap","messages","ACCESS_POLICY_RESTRICTION","APP_RESTRICTION_MESSAGE_TYPE","DOWNLOAD_CONTROL","LIST_ACCESS_LEVEL","SHARED_LINK_ACCESS_LEVEL","APP","BOX_SIGN_REQUEST","DOWNLOAD","EXTERNAL_COLLAB","SHARED_LINK","WATERMARK","DEFAULT","WITH_APP_LIST","WITH_OVERFLOWN_APP_LIST","DESKTOP","MOBILE","WEB","BLOCK","WHITELIST","BLACKLIST","COLLAB_ONLY","COLLAB_AND_COMPANY_ONLY","PUBLIC","getShortSecurityControlsMessage","controls","items","app","boxSignRequest","download","externalCollab","sharedLink","watermark","sharing","accessLevel","push","message","shortSharingDownloadAppSign","shortSharingDownloadApp","shortDownloadAppSign","shortSharingAppSign","shortSharingDownloadSign","shortSharingSign","shortDownloadSign","shortAppSign","shortSharingDownload","shortSharingApp","shortDownloadApp","shortSign","shortSharing","shortDownload","shortApp","shortWatermarking","getSharedLinkMessages","sharingCollabOnly","sharingCollabAndCompanyOnly","getWatermarkingMessages","isWatermarkEnabled","watermarkingApplied","getExternalCollabMessages","externalCollabBlock","externalCollabDomainList","getAppDownloadMessages","maxAppCount","appDownloadRestricted","apps","length","appsToDisplay","slice","remainingAppCount","appNames","map","displayText","join","appsList","values","tooltipMessage","allAppNames","messageType","getDownloadMessages","web","mobile","desktop","downloadRestrictions","platform","restrictions","Object","keys","forEach","platformKey","restrictExternalUsers","restrictManagedUsers","externalRestricted","externalAllowed","default","getBoxSignRequestMessages","isBoxSignRequestRestrictionEnabled","boxSignRequestRestricted","getFullSecurityControlsMessages"],"mappings":"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","sourcesContent":["// @flow\nimport getProp from 'lodash/get';\nimport isNil from 'lodash/isNil';\n\nimport type { Controls, MessageItem } from '../flowTypes';\n\nimport appRestrictionsMessageMap from './appRestrictionsMessageMap';\nimport downloadRestrictionsMessageMap from './downloadRestrictionsMessageMap';\nimport messages from './messages';\nimport {\n    ACCESS_POLICY_RESTRICTION,\n    APP_RESTRICTION_MESSAGE_TYPE,\n    DOWNLOAD_CONTROL,\n    LIST_ACCESS_LEVEL,\n    SHARED_LINK_ACCESS_LEVEL,\n} from '../constants';\n\nconst { APP, BOX_SIGN_REQUEST, DOWNLOAD, EXTERNAL_COLLAB, SHARED_LINK, WATERMARK } = ACCESS_POLICY_RESTRICTION;\nconst { DEFAULT, WITH_APP_LIST, WITH_OVERFLOWN_APP_LIST } = APP_RESTRICTION_MESSAGE_TYPE;\nconst { DESKTOP, MOBILE, WEB } = DOWNLOAD_CONTROL;\nconst { BLOCK, WHITELIST, BLACKLIST } = LIST_ACCESS_LEVEL;\nconst { COLLAB_ONLY, COLLAB_AND_COMPANY_ONLY, PUBLIC } = SHARED_LINK_ACCESS_LEVEL;\n\nconst getShortSecurityControlsMessage = (controls: Controls): Array<MessageItem> => {\n    const items = [];\n    const { app, boxSignRequest, download, externalCollab, sharedLink, watermark } = controls;\n\n    // Shared link and external collab restrictions are grouped\n    // together as generic \"sharing\" restrictions\n    const sharing = (sharedLink && sharedLink.accessLevel !== PUBLIC) || externalCollab;\n\n    // 4 restriction combinations\n    if (sharing && download && app && boxSignRequest) {\n        items.push({ message: messages.shortSharingDownloadAppSign });\n    }\n    // 3 restriction combinations\n    else if (sharing && download && app) {\n        items.push({ message: messages.shortSharingDownloadApp });\n    } else if (download && app && boxSignRequest) {\n        items.push({ message: messages.shortDownloadAppSign });\n    } else if (sharing && app && boxSignRequest) {\n        items.push({ message: messages.shortSharingAppSign });\n    } else if (sharing && download && boxSignRequest) {\n        items.push({ message: messages.shortSharingDownloadSign });\n    }\n    // 2 restriction combinations\n    else if (sharing && boxSignRequest) {\n        items.push({ message: messages.shortSharingSign });\n    } else if (download && boxSignRequest) {\n        items.push({ message: messages.shortDownloadSign });\n    } else if (app && boxSignRequest) {\n        items.push({ message: messages.shortAppSign });\n    } else if (sharing && download) {\n        items.push({ message: messages.shortSharingDownload });\n    } else if (sharing && app) {\n        items.push({ message: messages.shortSharingApp });\n    } else if (download && app) {\n        items.push({ message: messages.shortDownloadApp });\n    }\n    // 1 restriction combinations\n    else if (boxSignRequest) {\n        items.push({ message: messages.shortSign });\n    } else if (sharing) {\n        items.push({ message: messages.shortSharing });\n    } else if (download) {\n        items.push({ message: messages.shortDownload });\n    } else if (app) {\n        items.push({ message: messages.shortApp });\n    }\n\n    if (watermark) {\n        items.push({ message: messages.shortWatermarking });\n    }\n\n    return items;\n};\n\nconst getSharedLinkMessages = (controls: Controls): Array<MessageItem> => {\n    const items = [];\n    const accessLevel = getProp(controls, `${SHARED_LINK}.accessLevel`);\n\n    switch (accessLevel) {\n        case COLLAB_ONLY:\n            items.push({ message: messages.sharingCollabOnly });\n            break;\n        case COLLAB_AND_COMPANY_ONLY:\n            items.push({ message: messages.sharingCollabAndCompanyOnly });\n            break;\n        default:\n            // no-op\n            break;\n    }\n    return items;\n};\n\nconst getWatermarkingMessages = (controls: Controls): Array<MessageItem> => {\n    const items = [];\n    const isWatermarkEnabled = getProp(controls, `${WATERMARK}.enabled`, false);\n\n    if (isWatermarkEnabled) {\n        items.push({ message: messages.watermarkingApplied });\n    }\n\n    return items;\n};\n\nconst getExternalCollabMessages = (controls: Controls): Array<MessageItem> => {\n    const items = [];\n    const accessLevel = getProp(controls, `${EXTERNAL_COLLAB}.accessLevel`);\n\n    switch (accessLevel) {\n        case BLOCK:\n            items.push({ message: messages.externalCollabBlock });\n            break;\n        case WHITELIST:\n        case BLACKLIST:\n            items.push({ message: messages.externalCollabDomainList });\n            break;\n        default:\n            // no-op\n            break;\n    }\n    return items;\n};\n\nconst getAppDownloadMessages = (controls: Controls, maxAppCount?: number): Array<MessageItem> => {\n    const items = [];\n    const accessLevel = getProp(controls, `${APP}.accessLevel`);\n\n    switch (accessLevel) {\n        case BLOCK:\n            items.push({ message: messages.appDownloadRestricted });\n            break;\n        case WHITELIST:\n        case BLACKLIST: {\n            const apps = getProp(controls, `${APP}.apps`, []);\n\n            maxAppCount = isNil(maxAppCount) ? apps.length : maxAppCount;\n            const appsToDisplay = apps.slice(0, maxAppCount);\n            const remainingAppCount = apps.slice(maxAppCount).length;\n            const appNames = appsToDisplay.map(({ displayText }) => displayText).join(', ');\n\n            if (remainingAppCount) {\n                const appsList = apps.map(({ displayText }) => displayText).join(', ');\n\n                items.push({\n                    message: {\n                        ...appRestrictionsMessageMap[accessLevel][WITH_OVERFLOWN_APP_LIST],\n                        values: { appNames, remainingAppCount },\n                    },\n                    tooltipMessage: {\n                        ...messages.allAppNames,\n                        values: { appsList },\n                    },\n                });\n            } else {\n                // Display list of apps if available, otherwise use generic\n                // app restriction copy\n                const messageType = apps.length ? WITH_APP_LIST : DEFAULT;\n\n                items.push({\n                    message: {\n                        ...appRestrictionsMessageMap[accessLevel][messageType],\n                        values: { appNames },\n                    },\n                });\n            }\n            break;\n        }\n        default:\n            // no-op\n            break;\n    }\n    return items;\n};\n\nconst getDownloadMessages = (controls: Controls): Array<MessageItem> => {\n    const items = [];\n    const { web, mobile, desktop } = getProp(controls, DOWNLOAD, {});\n\n    const downloadRestrictions = {\n        [WEB]: {\n            platform: WEB,\n            restrictions: web,\n        },\n        [MOBILE]: {\n            platform: MOBILE,\n            restrictions: mobile,\n        },\n        [DESKTOP]: {\n            platform: DESKTOP,\n            restrictions: desktop,\n        },\n    };\n\n    Object.keys(downloadRestrictions).forEach(platformKey => {\n        const { platform, restrictions } = downloadRestrictions[platformKey];\n\n        if (!restrictions) {\n            return;\n        }\n        const { restrictExternalUsers, restrictManagedUsers } = restrictions;\n\n        if (restrictManagedUsers && restrictExternalUsers) {\n            items.push({ message: downloadRestrictionsMessageMap[platform].externalRestricted[restrictManagedUsers] });\n        } else if (restrictManagedUsers) {\n            items.push({ message: downloadRestrictionsMessageMap[platform].externalAllowed[restrictManagedUsers] });\n        } else if (restrictExternalUsers) {\n            items.push({ message: downloadRestrictionsMessageMap[platform].externalRestricted.default });\n        }\n    });\n\n    return items;\n};\n\nconst getBoxSignRequestMessages = (controls: Controls): Array<MessageItem> => {\n    const isBoxSignRequestRestrictionEnabled = getProp(controls, `${BOX_SIGN_REQUEST}.enabled`, false);\n    const items = isBoxSignRequestRestrictionEnabled ? [{ message: messages.boxSignRequestRestricted }] : [];\n\n    return items;\n};\n\nconst getFullSecurityControlsMessages = (controls: Controls, maxAppCount?: number): Array<MessageItem> => {\n    const items = [\n        ...getSharedLinkMessages(controls),\n        ...getExternalCollabMessages(controls),\n        ...getDownloadMessages(controls),\n        ...getAppDownloadMessages(controls, maxAppCount),\n        ...getWatermarkingMessages(controls),\n        ...getBoxSignRequestMessages(controls),\n    ];\n    return items;\n};\n\nexport { getShortSecurityControlsMessage, getFullSecurityControlsMessages };\n"],"file":"utils.js"}